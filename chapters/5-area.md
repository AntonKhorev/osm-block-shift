---
title: Выбор области сдвига
---

Наша операция по сдвигу начинается с решения о том, что именно надо сдвигать. Мы, казалось бы, уже определились с областью сдвига: это квартал. Несмотря на это, у нас по прежнему может оставаться вопрос, где именно провести границу квартала. Насколько это существенный вопрос, зависит от того, что уже нарисовано. В самом простом случае на краю квартала нарисованы здания, и между ними и highway-линией улицы ничего больше нет. Тогда мы условно проведём границу области сдвига так, чтобы здания в неё вошли, а улица не вошла. Как провести границу реально, написано в следующем разделе. Конечно, возможен и ещё более простой случай, когда не нарисованы даже и здания, но тогда нам незачем действовать согласно данной записи.

Что может быть уже отмечено между внешними зданиями и линией улицы? Всё, что угодно, что там есть или было, и что осмеры посчитали нужным к данному моменту ввести. В первую очередь это тротуар.[^5-separate-sidewalk] Мы начали эту запись с того, что представили себе осмера, вводящего подобные объекты, и обнаружившего, что уже имеющиеся данные ему это делать мешают. Правда, также мы представили, что он, возможно, хочет вводить свои объекты относительно имеющихся данных. Чтобы такое произошло, определённые данные уже должны быть добавлены на момент ввода новых объектов. В общем, можно утверждать, что данные вводятся согласно изменяющимся во времени предпочтениям осмеров, которые зависят от уже введённых данных, и для чего мы можем указать некоторые закономерности.

[^5-separate-sidewalk]: Тротуары, если таковые вообще имеются, могут быть обозначены отдельными линиями {% tag "footway=sidewalk" %} или тегами {% tag "sidewalk=*" %} на линиях улиц. В этой записи при рассмотрении тротуаров мы будем подразумевать отдельные линии по нескольким причинам. Во-первых, если тротуар не обозначен отдельной линией, у него нет отдельной геометрии в осмовских данных. Нам, интересующимся в настоящий момент преобразованиями геометрии, не понадобится такой тротуар рассматривать. Во-вторых, можно предположить, что при рассматриваемом уровне детализации рисование тротуаров отдельными линиями будет являться целью участников. Если у нас достаточно данных внутри квартала, которые мы не хотим испортить его перемещением, тротуар вокруг него нам уже не будет казаться лишним. Кроме того, внутри квартала, вероятно, будет достаточно проходов, каждый из которых не обязательно важнее тротуара. Для того, кто взялся их рисовать, логичным будет изобразить и тротуар, особенно если эти проходы с ним соединяются. Это примечание про тротуары отдельными линиями приводится здесь, потому что до сих пор высказываются мнения, что линии тротуаров лишние, они лишь загромождают данные, обозначать тротуары не имеет смысла, так как и так ясно, что они есть у каждой улицы они есть по обеим сторонам, тротуары не являются отдельными от улицы объектами и так далее. Мы булем считать, что там, где подобные мнения распространены, карта ещё не достигла существенного уровня детализации, при котором наши неосторожные действия по перемещению могут многое испортить.

## Эволюция данных

В предыдущем разделе мы уже заметили, что мелкие объекты часто рисуются после и относительно крупных. По-другому это можно было бы сказать так: менее значимые объекты рисуются после и относительно более значимых. Это звучит уже менее определённо: мало ли, что для кого более значимо. Но и первый вариант неоднозначен. В этом подразделе мы назвали такие объекты, как здания и тротуары. Что больше - здание или тротуар? Если судить по длине, то обычно тротуар, если по площади, то может получиться по-разному. Вряд ли участник, рисующий тротуар, оценивает и с чем-то сравнивает его площадь. Так что мы не сможем в общем случае дать полностью однозначного ответа на вопрос, что было и будет нарисовано раньше, и что было и будет нарисовано относительно чего. С другой стороны и полностью неоднозначным этот ответ не является.

В итоге можно изобразить модель эволюции данных в определённом месте. Она получится в виде [ориентированного графа](https://ru.wikipedia.org/wiki/Ориентированный_граф), разные ветви которого соответствуют объектам с несравнимой значимостью. Несравнимая значимость для объектов типов А и Б - это когда одна группа участников утверждает, что важнее тип А, а другая - что тип Б. При этом обе группы достаточно активны, чтобы оказать заметное влияние на порядок ввода данных в местах своей активности. Ранее, в подразделе "мои данные важнее" мы уже рассматривали подобное утверждение, и тогда мы признали его неверным для правок отдельного участника в существенной степени на основе последовательности ввода данных большинством. По последовательности ввода большинством или существенной группой участников мы и можем судить об общепринятой значимости разных типов объектов.

Внимательные читатели, конечно, заметили в сказанном выше [круговую логику](https://ru.wikipedia.org/wiki/Круговое_рассуждение): вводится раньше то, что важнее, а важнее то, что вводится раньше. Действительно, анализ эволюции данных можно было бы провести аккуратнее, но для данной записи и так сойдёт. Если вас это сильно смущает, то забудьте, что в этом подразделе значимость упоминалась вообще. Можно считать, что мы просто видим последовательность ввода данных в интересующих нас условиях и ожидаем её повторения в подобных условиях, причины же всего этого нам неизвестны. Некоторые причины важности помимо последовательности, кстати, тоже указывались в предыдущем разделе.

Перед тем, как привести диаграмму, сделаем ещё несколько примечаний. Первое, что нужно отметить, это то, что пока она основана на моих впечатлениях без количественных оценок. Более точно её можно было бы получить, взяв репрезентативную выборку городов и проследив изменение данных для них. Позже я, возможно, это проделаю. Далее, раз уж была упомянута выборка городов, надо заметить, что рассматриваем мы только ситуацию в городе с достаточно чётко определёнными улицами и кварталами, а не в другом виде местности, например, в лесу. В лесу, кстати, тоже могут быть [кварталы](https://wiki.openstreetmap.org/wiki/RU:Tag:boundary%3Dforest_compartment), но у нас речь идёт не о них. Наконец, отметим, что указанная модель эволюции годится только для тех мест, объекты в которых существовали до начала осмерской активности. Если квартал мапится во время своего строительства, дела могут обстоять по-другому.

<p class="notice">
В данном месте должна быть диаграмма, про которую можно сказать примерно то же, что и про блок-схему из предыдущей главы: она, кажется, существует на листе бумаги, и этот лист надо найти.
</p>
