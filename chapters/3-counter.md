---
title: Аргументы против
---

Нам бы хотелось сказать, что если здания закрывают собой место для тротуара или чего-либо ещё, что необходимо дорисовать, то надо *просто* сдвинуть квартал, но, к сожалению, это не совсем просто. По крайней мере, для этого могут потребоваться некоторые объяснения, к которым мы и перейдём в следующих главах. Поскольку для многих действительно проще двигать точки по отдельности, то эти объяснения их могут не интересовать. Им может быть интереснее приводить аргументы в пользу того, что их способ редактирования правильный, и эти аргументы нам придётся разобрать.

Если вы уже уверены, что вы хотите сдвинуть квартал целиком, вас не нужно в этом убеждать, и вам не нужно убеждать в этом других, то данная глава не для вас, можете смело переходить к следующей.

## Мои данные важнее { #mine-is-more-important }

Некоторые могут заявить, что данные, которые они собираются ввести, гораздо важнее уже имеющихся в базе. Эти более важные данные нужно ввести как можно быстрее и преодолевая как можно меньше препятствий, из чего следует допустимость искажений существующих данных, если искажения облегчают процесс ввода.

В действительности, при прочих равных условиях, те данные, которые уже введены, скорее более важны, чем те, которые ещё не введены. Логично предположить, что более важные данные вводились бы в первую очередь. Конечно же, для того, кто хочет ввести новые данные, покорёжив старые, более важны новые, но речь идёт не о важности для отдельного участника, а о важности для *всех*. Существующие данные были введены какими-то участниками, которые и выступили в роли *представителей всех*. Остальные участники выразили с ними согласие, оставив эти данные в соответствующем виде.

Дальше, конечно, наш оправдывающийся участник тоже может объявить себя *представителем всех*, приводящим данные ко всех устраивающему виду. Это сработает, если против его правок никто не будет возражать, но тогда и оправдываться ему будет не перед кем. Если оправдываться пришлось, то аргумент про бо́льшую важность становится значительно слабее. Тем же, кому надо ввести важные для них данные без помех со стороны других, можно посоветовать вводить их не в осм.

Если сказанное было верно при прочих равных условиях, то какие могут найтись неравные условия, влияющие на порядок ввода данных? Не равна может быть доступность данных и простота их ввода. Собственно, простотой ввода и объясняются действия оправдывающегося. Будь проще поступить так, как будет написано в следующих главах, участник так бы и сделал. При таких условиях поступить иначе захотел бы только вандал, но вандалом участник, скорее всего, не является. В осме большая часть искажений данных является не [вандализмом](https://wiki.openstreetmap.org/wiki/RU:Вандализм), а побочным эффектом от попыток пополнить данные. Это явление говорит нам не только о состоянии сообщества участников, но и о состоянии средств редактирования.

Про доступность данных в общем случае можно сказать следующее: если данные более сложно получить, то их ввод состоится позже. Доступность данных обычно выражается в их видимости на спутниковых снимках. Часто данные вводят только по таким снимкам, но даже если и нет, они служат удобным ориентиром. Обычно именно по ним рисуются здания, газоны и прочие площадные объекты, о сохранении формы которых мы пытаемся позаботиться в данной записи. Соответственно, можно попытаться объяснить их очерёдность ввода не важностью, а доступностью для *диванных картографов*. Возразить на это можно так: видимость этих объектов придаёт им важности. Важность здесь имеется в виду не только для конечного пользователя, но и для процесса редактирования.

Мы начали с необходимости обозначить какой-то объект в том числе и относительно зданий. Если бы здания были не важны, то данная необходимость не возникла бы. Оправдывающийся участник может возразить, что ему здания и не важны, он просто хочет, чтобы его данные не отображались поверх зданий. На это мы ему ответим, что то, что здания где-то отображаются, тоже говорит об их важности. На рендерах они отображаются весьма заметно, так что некоторые участники ради этого отображения обозначают зданиями даже то, что зданиями не является. Так поступать, конечно, не следует, зато это является признанием заметности отображения зданий, а заметность свидетельствует о важности.

Напоследок приведём одну из наиболее крайних версий рассматриваемого оправдания, возникающую при коммерческом редактировании. Участнику платят за ввод определённых данных, а в сохранности других данных у него заинтересованности нет. Заинтересованность есть в том, чтобы как можно быстрее выполнить работу. Правда, в таком виде оправдание публично высказано не будет, участник может только лишь приготовить его для самого себя, ведь не станет же он говорить о необходимости *подвинуть* осмовские данные, потому что за это заплачено. Те, кто занимается коммерческим редактированием, вообще бы предпочли, чтобы факт оплаты правок никто не заметил. Даже те участники, место работы которых известно, могут утверждать, что *конкретно вот эта правка* не является оплаченной, так как выполнена вне их служебных обязанностей. Верить в это вовсе не обязательно, как и во все прочие оправдания, даже если высказывающие их смогли убедить ими самих себя.

## Я ещё не закончил

Признавая вносимые ими искажения, некоторые участники могут заявить, что внесены эти искажения были временно, и скоро их планировалось исправить. Подобное заявление бывает предъявлено после [отката правок](https://wiki.openstreetmap.org/wiki/RU:Откат_правки) в качестве причины того, что откат делать не следовало.

Самый простой ответ, который можно на это дать - нет, исправлять вы ничего не собирались. Как можно восстановить утраченную в результате правки информацию? Легче всего это сделать откатом, что с вашей правкой и было проделано. Вряд ли вы собирались делать правку, которую вы сами собирались откатить. Иногда имеет смысл вносить правки с запланированным последующим откатом, но это, как правило, [выборочный откат](https://wiki.openstreetmap.org/wiki/JOSM/Plugins/Reverter#Partial_reverts) определённого подмножества затронутых элементов. Чтобы это было применимо к рассматриваемым здесь правкам, ситуация должна быть такой: что-то рисуется, ради чего искажается форма зданий, а потом это будет подвинуто и форма зданий возвращена. Это маловероятно, так как легче было бы сразу внести новые данные на нужное место. Другой вариант: новые данные так и останутся на месте, а форма зданий будет восстановлена, после чего они будут более аккуратно сдвинуты, уже с учётом новых данных. Это более логичный вариант, но ещё логичнее было бы сразу всё аккуратно сдвинуть, а этого сделано не было, потому что *лень / и так сойдёт / не умею*. Здесь предлагается поверить, что эти причины в скором времени должны исчезнуть, а это не очень правдоподобно.

Может быть, откат был действительно совершён слишком быстро? "Слишком быстро" - это не очень определённый промежуток времени, так что неплохо было бы уточнить, слишком быстро *для чего*. Если мы уверены в том, что все правки участника будут сопровождаться искажениями данных, то никакого "слишком быстро" быть не может в принципе - откатывать их надо как можно быстрее. Но, допустим, участник действительно собирается исправить свои правки. Тогда, чтобы оценить общую пользу от его действий, нам надо знать сроки исправлений. В этом случае мы сможем сопоставить ущерб от искажения данных в течение определённого времени с пользой от внесения новых данных.

Тут можно возразить, что это нечестно, ведь у новых данных нет конечного срока существования, почему тогда нужен срок для искажений? Без этого срока сопоставление совершить гораздо проще, и, исходя из [предыдущего раздела](#mine-is-more-important), нетрудно догадаться, в какую сторону. Поскольку старые данные важнее новых, их бессрочное искажение перевесит бессрочную пользу от новых, следовательно правки были вредны. Объявления сроков исправлений перед правками обычно не происходит, да и после - тоже, так что сопоставление и будет простым, с решением в пользу отката.

Если мы знаем, что правки некачественные и откатывать их придётся, то, с точки зрения сроков этой операции, нас будет интересовать не только какое время существуют неправильные данные, но и простота отката. Чем дольше данные существуют в определённом виде, тем больше появляется данных, от этого вида зависящих. Если вид данных понадобится вернуть к предыдущему, то придётся что-то делать и с зависящими данными. Наиболее явно эта ситуация проявляется в виде конфликтов редактирования при откате. Конфликты, которые показываются в редакторе - это хорошо по сравнению с месивом из старых и новых данных, которое, вероятно, тоже возникнет в результате отката, и о котором редактор ничего не сообщит. Чтобы не приходилось тратить время на разрешение конфликтов и разгребание месива, правки надо откатить как можно быстрее.

Кстати, один из способов разрешения конфликтов это тоже откат - откат пакетов, вызвавших конфликты. Это касается пакетов, состоящих из исправлений описанных выше искажений, выполненных уже другим участником. Поскольку все искажения исправит откат исходных правок, такие выполненные вручную исправления становятся не нужны. Более того, они мешают, так как точно приводят к конфликтам, если их не включить в общий план отката, для чего их надо сначала обнаружить. Обнаружение, скорее всего, и состоится в виде проявившегося во время отката конфликта редактирования. В заметных и важных местах подобные ручные исправления и будут основным источником конфликтов. Получается, что данные надо успеть *исправить правильно* до того, как их *исправили неправильно*.

Серьёзные промежуточно неправильные изменения держать в базе можно было бы при поддержке [бренчинга](https://en.wikipedia.org/wiki/Branching_(version_control)). Такой поддержки, конечно же, нет, и даже непонятно, возможно ли её в условиях осма реализовать. Часто её нет и в других непрограммистских проектах совместного редактирования, например, в вики. В вики-проектах, таких как [Википедия](https://www.wikipedia.org/) её было бы и легче реализовать, и она была бы нужнее. Легче реализовать её было бы потому, что все данные поделены на относительно независимые страницы, а в осме такого нет. В данной записи мы пытаемся в качестве относительно независимых порций данных считать кварталы, но в отличие от вики-страниц, у них нет явно определённых с точки зрения хранения данных границ. Если в вики история редактирования существует именно для отдельной страницы, то в осме она определена для всей планеты целиком. Предоставлять пользователям делать свою ветку для всей планеты, то есть всех данных проекта - это куда более серьёзный шаг, чем делать то же для статьи, в которой не больше одной миллионной от всех данных проекта.

Нужнее же бренчинг в вики был бы потому, что структура статьи слабо определяется её предметом. Представьте себе, что вы пишете в Википедии статью про учёного. Будете ли вы отделять его *личную* биографию от *научной*? Можно как отделять, так и излагать их совместно, и переход между этими вариантами может быть нетривиален. В процессе его выполнения промежуточные версии будут не слишком пригодны для использования, и даже для некоторых видов редактирования, так что предложение потерпеть промежуточные версии в качестве основных широкой поддержки не найдёт. Именно такое предложение и делает наш участник в осме, но при правильном выполнении перехода между разными смещениями непригодные промежуточные версии бы не возникали.

Отложим пока рассуждения про бренчинг и вернёмся к нашему простому ответу, в котором мы утверждаем, что участник не собирался делать исправлений. Как и требование сообщить срок исправлений, это выглядит нечестно. Здесь мы приписываем участнику намерения, а потом судим его по этим же намерениям. Но мы начали с того, что участник сам приписал себе намерения позже внести исправления, и хочет, чтобы его судили по ним. Если принятие решения на основании намерений его не устраивает, то и его оправдания не годятся.

Ещё можно вспомнить, что в подобных осму проектах рекомендуется предполагать добрые намерения, а мы в нашем ответе, вроде бы, этого не делаем. На самом деле, мы вообще доброту намерений здесь не оцениваем, так как для нас она не важна. Мы не говорим, что свои правки участник делал ради того, чтобы портить данные. Как уже было сказано, в этой записи случаи явного вандализма мы не рассматриваем, и вандалы читать её не будут. К сожалению, излишне упёртые *не-вандалы* читать её тоже не будут, так что она их не переубедит.

Если же участник будет по прежнему настаивать на своих намерениях, то придётся объяснить ему, что он сам подталкивает нас к обсуждению его личности. Причины говорить неправду как про намерения исправить, так и про сроки исправлений у него имеются. Значит нам придётся оценивать репутацию участника. Если он зарегистрирован недавно или уже занимался подобным, а так оно обычно и бывает, то это будет серьёзным основанием ему не верить. В целом, такими вещами нам заниматься не хотелось бы, так что цель нашего ответа - не обозначить намерения участника, а прекратить рассуждения о них, и, вместо перехода на личности, перейти к обсуждению действий.

## Я не так сильно исказил данные

Ещё один вариант признавать вносимые искажения, но не признавать, что они достаточно серьёзные - это приуменьшить их эффект. Этот аргумент может выступать в качестве приправы к "Мои данные важнее".

Допустим, участник хочет нарисовать что-то находящееся рядом со стеной здания, а в реальности стена по его мнению находится в нескольких метрах от того места, которое обозначено в данных. В связи с этим, участник сдвинет отрезки стены в данных на нужное ему место, как это было описано в начале данной записи. Если обратить его внимание на описанные там же отрицательные последствия этого действия, то участник возразит, что стену он сдвинул чуть-чуть, всего на несколько миллиметров, и никакого значения этот сдвиг не имеет. Если заодно он захочет употребить "Мои данные важнее", то к этому он добавит, что незначительная модификация существующих данных позволила ему ввести новые важные данные, а, значит, оно того стоило.

Если бы модификация действительно была незначительная, не было бы необходимости её проводить. Если бы стена в данных действительно отстояла на несколько миллиметров от своего реального положения, это не помешало бы пользователю добавить свои данные. Он же не будет утверждать, что он рисует с миллиметровой точностью, по крайней мере, пока таких утверждений я не встречал. Может быть, мы тут придираемся к пользователю и требуем от него излишней точности в оценке выполненного им смещения? Точности тут никакой и близко нет, между миллиметрами и метрами разница в тысячу раз. Какой смысл рассказывать про миллиметры тому, кто знает, насколько данные были сдвинуты на самом деле? Смысл может быть только для убеждения сторонних наблюдателей, а, может быть, и самого себя.

Как ещё можно объяснить подобные преуменьшения? Может быть, участник имеет в виду миллиметры на экране своего монитора? Тогда любое расстояние можно превратить в миллиметры подходящим выбором масштаба. Значит, такая интерпретация для обсуждения данных не годится. Скорее всего, миллиметры имелись в виду не буквальные, и в некоторых местах участник вносил действительно небольшие изменения. Более серьёзные изменения он мог не заметить и не оценить тогда и может не хотеть обращать на них внимания сейчас. Зачем производить усилия, которые могут доказать собственную неправоту? Например, чтобы делать более правильные правки. Но эта причина участнику покажется недостаточной, если он считает свои правки и так достаточно правильными. Ну или участник мог сделать выводы лично для себя, а на публике продолжать делать вид, что в его правках никаких существенных недостатков не было. Некоторые так поступают на протяжении нескольких лет.

## У вас неправильное смещение

Иногда участник выдвигает грандиозное предположение, что значительная область с данными в осме смещена относительно истинного положения. Точнее, не выдвигает предположение, а демонстрирует уверенность, и делает это не разговорами, а правками. Может такое быть на самом деле? Конечно, может. Более того, так всегда и есть, ведь невозможно внести данные абсолютно точно. Вопрос в том, насколько всё смещено и в какую сторону. Наш случай - это когда участник утверждает, что всё смещено на большее расстояние, чем того можно было бы ожидать. Дальше у нас остаются два варианта:  либо всё смещено одинаково, либо по-разному.

Существующие данные действительно могут быть смещены как одинаково, так и по разному. Это зависит от того, о каких данных мы говорим. Здесь нас интересуют полигоны зданий и линии улиц. Полигоны зданий могут быть смещены относительно друг друга даже внутри одного квартала, что может быть связано с методом, по которому они рисовались. К зданиям больше относятся рассуждения из [следующего раздела про неправильную геометрию](#wrong-geometry), а в этом нас интересуют более глобальные утверждения. Эти более глобальные утверждения будут касаться и улиц, так что сдвиги улиц мы здесь и рассмотрим.

Часто попадается ситуация, когда здания и улицы смещены относительно друг друга. Это можно увидеть, наложив на осмовские данные снимок, сделанный под [углом, близким к прямому](https://en.wikipedia.org/wiki/Nadir#Space_science). Ясно, что в этом случае что-то двигать придётся. Если вы не знаете, что именно, то первым предположением должны быть здания. Причины этого следующие: часто мапить начинают именно с улиц, для них могут быть доступны треки или иметься возможность треки записать, а относительно них уже выравниваются остальные данные. Иногда остальные данные выровнять забывают или сознательно этого не делают, так как это не всегда просто, и в результате появляется разница с улицей.

В рассматриваемом нами случае участник двигает улицы, даже если до того они совпадали с треками. От треков есть толк, конечно, не всегда. Например, смотреть на треки для узких или кривых улиц, улиц с односторонним движением или со зданиями только с одной стороны может быть бесполезно. Об этом может вспомнить и участник, упомянув что-либо из вышеперечисленного как повод не рассматривать треки вообще. Насколько он неправ, зависит как раз от того, пытается ли он сдвинуть всё примерно одинаково, или действует в разных местах по-разному.

Узкие, кривые и прочие подобные улицы как раз весьма вероятно нарисованы не на месте, как и здания рядом с ними, так что проблема не в самом их сдвиге. Если участник сдвигает только такие данные, то конкретно та причина, которая рассматривается в этом разделе может быть правильной, хотя это не значит, что правильно осуществляется сам сдвиг. Как мы знаем, пытаясь двигать вручную каждую точку по отдельности, можно внести в данные существенные искажения. Искажения могут получиться, например, за счёт того, что некоторые точки можно забыть подвинуть, что тем более вероятно, чем крупнее область сдвига. Можно просто устать двигать каждую из множества точек и перепутать ещё не подвинутые с уже подвинутыми.

Если же сдвиги участника захватывают и прямые широкие улицы, относительно треков по которым сомнений может быть гораздо меньше, то тогда рассматриваемая причина не подходит. Именно так и будет, если он попытается сдвинуть всё одинаково везде. Аргумент о том, что треки якобы сдвинуты из-за помех от зданий не будет убедительным, если они сдвинуты на точно такое же расстояние в точно таком же направлении и там, где здания близко к дороге, и там, где далеко, там, где они с одной стороны улицы, с другой стороны или с обеих.

Под "сдвинуть всё одинаково везде" мы подразумеваем как намерение, так и его реализацию, причём ни то, ни то может не делаться в полной мере. Реализация, как мы уже отметили, может заключаться в двигании всего по отдельности, из-за чего одинакового сдвига не получится, даже если участник его хотел. С другой стороны, у участника могло не быть намерения двигать всё одинаково, хотя его правки соответствуют попыткам такой сдвиг осуществить. Сам участник может это не замечать и не осознавать. Мысли про одинаковый сдвиг он может избегать, потому что рассуждения в этом направлении могут привести его к осознанию того, что он делает что-то неправильно. Вместо этого, скорее, им будет высказано мнение, что смещения данных до него были хаотичные, из чего следует необходимость двигать всё по-отдельности. Также он может заявить, что даже если всё нужно было бы подвинуть одинаково на достаточно большой площади, действовать иначе, чем действовал он всё равно было бы нельзя. Это мы рассмотрим позже.

Данная запись не про сдвиг больших площадей, а про сдвиг кварталов, так что она не вполне помогла бы участнику, если бы он хотел именно первого. Однако даже сдвиг по кварталам дал бы результат гораздо лучше, чем сдвиги отдельных точек. Так или иначе, необходимость сдвига большой области надо сначала установить. Если участник при этом не является её единственным редактором, ему бы стоило договориться с остальными, например, в разделе [форума](https://community.openstreetmap.org/c/communities/9/none), посвящённом соответствующей области. У других участников могут быть серьёзные причины считать текущее положение правильным и помимо треков.

Да и сами треки часто дают очень хороший результат. Каждый отдельный трек может быть весьма неточен, зато среднее от множества независимо полученных треков гораздо точнее. Ещё один важный факт насчёт треков - это то, что они почти наверняка были получены непосредственно в системе координат WGS-84, что нам и нужно. Даже очень точные измерения в другой системе могут дать неудовлетворительный результат после преобразования. Есть вероятность, что участник, считающий треки неточными и обладающий более точными измерениями, как раз такими преобразованиями занимался. Именно на основании неправильного преобразования можно получить систематическую ошибку, когда всё будет сдвинуто на определённое расстояние. Заметить такую ошибку может помешать излишняя уверенность в собственной правоте.

Сама же уверенность в своей правоте могла возникнуть у участника в результате того, что подобные действия он уже выполнял в других местах и не встретил там сопротивления. Это может объясняться тем, что не за всеми местами хорошо следят. Кое-где можно месяцами заниматься даже явным вандализмом, и этого никто не заметит. В результате любые разговоры с участником могут оказаться бесполезными, если они не подкреплены блокировкой от DWG. В особо запущенных случаях не поможет и блокировка.

Тут можно снова вспомнить про отсутствие бренчинга. Возможно, он помог бы в ситуациях, когда участники действительно не могут договориться о том, какие координаты правильные. Хотя лучше бы помогла локальная система координат. Ясно, что такого нет и не будет, потому что непонятно, для каких локаций её вводить. В итоге отсутствие всего этого с одной стороны форсирует нахождение консенсуса участниками, а с другой стороны вызывает нарушение этого консенсуса другими участниками. Бренчинг же остаётся у программистов, для которых любая несогласованность в исходниках будет означать кучу багов или невозможность билда. Для осмовских данных от этого последствия менее катастрофические, но лихие правки отдельно взятых участников могут угробить результаты сотен часов сбора данных.

## У вас некачественная геометрия { #wrong-geometry }

Участник может выразить мнение, что данные до него всё равно были некачественные, поэтому неважно, как он их двигает. При нарциссическом варианте этого аргумента участник уверен, что он всё рисует хорошо, а до него хорошо нарисовать рассматриваемое место никто не мог. Если провести аргумент ещё дальше, то участник может посчитать нужным "исправлять" ранее внесённые данные. Проблема в том, что эти "исправления" на самом деле таковыми не являются. В данном разделе мы рассматриваем случай, когда у участника либо не стояло цели что-либо исправлять и улучшать, либо у него нет для этого необходимых данных. Случай, когда такая цель и необходимая для её достижения информация у участника была, будет рассмотрен позже, а здесь никаких исправлений на самом деле либо не будет, либо они будут попытками восстановления данных, утраченных в результате корявых сдвигов.

Допустим, в данных было несколько точек, стоявших на одной прямой. Что получится, если участник сдвинет их по отдельности? Они уже не будут на одной прямой. Дальше участник может заметить это и расставить сдвинутые точки по прямой. Мы уже говорили, что обычно этого не делают, но может получиться так, что участник будет делать это в одних местах и не делать в других. Теперь допустим, что было несколько точек, *не* стоявших на одной прямой, причём не стоявших специально. Вдобавок к этому они расположены достаточно близко к какой-то прямой. Что получится после сдвига? Они по прежнему не будут на одной прямой. Дальше участник опять же может заметить это и расставить сдвинутые точки по прямой, что будет заменой одного искажения данных на другое.

Зачем он это будет делать, если точки на прямой не были? *Во-первых*, он может не помнить предыдущего расположения точек. Информация о нём в текущей версии данных утеряна, и восстановить её можно только по истории редактирования. Легче всего это сделать, конечно же, откатом, а это то, чего участник делать не захочет. И вообще, в истории копаться ему лень, а в данном месте ему почему-то хочется сделать "красиво", он ведь считает, что он может нарисовать лучше, несмотря на то, что редактируемого места в реальности он не видел. И отсюда мы придём к тому, что *во-вторых* он, как более качественный рисователь, "исправляет" некачественные данные, введённые до него. Но, как мы уже сказали, такие "исправления" на самом деле лишь являются побочными эффектами от сдвигов.

Помимо выстраивания в прямую точек, не стоявших на прямой, можно привести и другие примеры искажения данных посредством регуляризации. Это может быть, например, расстановка на одинаковые расстояния точек, находившихся на разных. Самым известным же примером является, видимо, нажатие в [JOSM](https://wiki.openstreetmap.org/wiki/RU:JOSM) на клавишу Q, которое призвано "улучшить" любую геометрию посредством спрямления всех непрямых углов. Заметить его могут помочь казалось бы лишние точки на прямых участков контуров полигонов - останки пропавших изгибов.

Мы назвали пару причин, по которым участник может захотеть "исправить" замеченную им кривую геометрию, но зачем ему её в принципе замечать? Рисует он и так криво, даже если этого и не осознаёт. Если он будет пытаться "исправить" всё подряд, то это сильно замедлит его редактирование, и массовые сдвиги с его стороны будут менее вероятны, а значит, он с меньшей вероятностью будет субъектом, описываемым в данной записи. Так что мы будем рассматривать именно селективные "исправления", выполняемые только в некоторых местах. Чем же именно эти места заслужили внимание участника?

Большее внимание к определённым местам может объясняться различными причинами, например, тем, что рядом с таким местом участник решил нарисовать что-то своё. Из всех причин мы выделим следующую - реакцию на критику. Участник изначально может сдвигать всё подряд, не заботясь о том, насколько кривее после его действий будут стоять точки, насколько исказятся пропорции объектов и так далее. После этого ему могут указать на сомнительность его правок и подкрепить это примерами с искажениями данных в определённых местах. Именно в этих местах могут и последовать "исправления" от участника, которые он проделает для того, чтобы устранить причины возмущения его правками.

Дополнительно участник может захотеть вести рассуждения типа *мне указали **n** ошибок, значит у меня всего **n** ошибок (и они уже исправлены)*. Эти рассуждения можно продолжать для любого **n**. Ошибок может быть хоть сто, и участник при подобных рассуждениях заявляет, что его надо ткнуть носом в каждую из этих ста ошибок. На самом деле подобный разбор в нашем случае бесполезен, так как указание ошибок ведёт к их псевдоисправлениям, которые придётся указывать снова, но главное - не было никаких причин эти ошибки допускать. Потом, участник может быть настолько уверен в себе, что никакие ошибки не признает, или перейти к другому аргументу: не допустить их было нельзя, потому что по-другому действовать нельзя.

Итак, разбор локальных ошибок нам может понадобиться признать бесперспективным. Однако, могут найтись сторонники мнения, что без подобного разбора откат будет несправедлив. Нам придётся обратить их внимание на то, что у выполняющего кривые правки есть преимущество по времени: кривые правки можно делать быстро. Собственно, их и делают, потому что так быстрее. В итоге участник может делать правки быстрее, чем вы их можете разбирать. Кроме того, очевидно, что правки всегда предшествуют своему разбору, так что даже разбор со скоростью выполнения правок не позволил бы содержать данные в приемлемом состоянии.

Вернёмся к основному предмету данного раздела. Как мы уже сказали, *исправления* и *улучшения* являются обычно исключениями. Основная же цель упоминания имеющихся до пришествия участника неточностей данных - оправдание его собственного неаккуратного обращения с ними. Отчасти участник может быть прав: кое-что действительно могло быть нарисовано криво. Проблема, однако, в том, что участник действует одинаково и где криво, и где не криво, а, значит, делает криво везде. Собственно, где не криво он и не знает, а, значит, по-другому действовать у него не получится, если он не откажется от ручного сдвига отдельных точек. Отказываться он может не захотеть, перейдя к уже упомянутому "по-другому действовать нельзя", так что и мы перейдём к этому.

## По-другому сдвинуть нельзя

Допустим, участник сдвигает значительную область с данными посредством перемещения каждой точки отдельно. Как можно было бы действовать по-другому? Например, выделить её в редакторе целиком и сдвинуть всё её содержимое вместе, в одном направлении и на одно расстояние. Проблемы с осуществлением этого могут возникнуть на этапе "выделить": если мы говорим о сдвиге квартала, то это несколько сотен элементов. Довольно трудоёмко выбирать каждый из них по отдельности, а инструментами для массового выбора типа прямоугольного окна или лассо тоже за один заход не выбрать всё, что нужно, так, чтобы при этом не выбрать и того, чего не нужно. Как именно такое выделение легче всего осуществить, мы рассмотрим позже, в [соответствующей главе](../6-select), но до описываемых там действий участник может не догадаться. Поэтому ему легче решить, что синхронный сдвиг сделать в принципе нельзя, и продолжать двигать точки по отдельности.

Возможен и другой вариант: участник сдвигает небольшую область, например, одну стену, а бо́льшая область его не интересует. Поскольку с большей областью, которой в нашем случае является квартал, он делать ничего не хочет и не хочет на неё даже смотреть, то ему ещё легче прийти к выводу, что бо́льшую область синхронно переместить невозможно. Сделать желаемый вывод ему помогут и прочие рассматриваемые выше и ниже аргументы, среди которых можно выделить "несдвинутое может там и находиться".

Если обсуждение правок участника дойдёт до выяснения причин невозможности синхронного сдвига, участнику придётся их изобретать на месте. Он же не может сказать, что невозможно сдвинуть квартал целиком, потому что его невозможно выделить. Ясно, что нет никаких фундаментальных причин невозможности выделения. Вариант с "я не хочу/умею" вместо "невозможно" тоже не вполне подходит для высказывания, хотя его можно преобразовать в ранее рассмотренные аргументы "мои данные важнее" и "я скоро исправлю", означающие "и так (пока) сойдёт". Вместо всего этого участник может зайти с противоположной стороны и сказать, что сдвиг точек по отдельности является более правильным, чем сдвиг их всех вместе.

Как можно попытаться объяснить большую правильность сдвига точек по отдельности? Иногда это объясняют сложностью данных. Объяснение это выглядит весьма странно, потому что логичнее было бы исходя из сложности прийти к противоположному выводу, что точки нужно сдвигать вместе. Может быть, мы не понимаем, что участник имеет в виду под сложностью данных? Мы могли бы попытаться получить от участника более подробные объяснения, но он, конечно же, постарается избежать их давать. Он знает, что ничего хорошего для сохранности его правок из этих разговоров не последует, ведь правки он уже сделал, а, значит, разговоры являются поиском причин к их откату. В случае же с массовыми правками участник очевидно не настроен говорить, иначе бы он обсуждал их до выполнения.

Попробуем самостоятельно догадаться, что имеется в виду под сложностью. Самое простое, что мы можем рассмотреть, это количество элементов в рассматриваемой области. *Сложнее* - это когда в ней *меньше* элементов или когда *больше*? Конечно, когда больше. При этом взгляде на сложность участник заявляет, что элементы сдвигать синхронно невозможно, потому что их слишком много. Этот аргумент мы уже только что рассмотрели, под сложностью данных здесь имеется в виду "мне лень либо я не умею выбирать элементы". Конечно, большее количество элементов сделает и синхронный сдвиг сложнее даже без учёта сложности выделения. В частности, придётся делать больше ручных поправок на границе области сдвига. Однако это не аргумент в пользу ручного сдвига, так как при нём делать такие же поправки всё равно придётся, если только не решить намеренно их не делать. Последнее будет сознательным искажением данных, что мы тоже уже рассматривали.

Попробуем придумать что-нибудь ещё, связанное со сложностью, например, взаимное расположение элементов. При сложных данных взаимное расположение элементов менее важно или более важно? Конечно, более важно. А какой сдвиг элементов в большей степени их взаимное расположение сохранит? Конечно, синхронный. Сложность, выражаемая тегами к делу не относится, так как сдвиги элементов на теги не влияют. То же самое можно сказать про явные связи одних элементов с другими, такие как вхождения точек в линии. Неявные же связи типа нахождения внутри полигона можно отнести ко взаимному расположению, и обилие таких связей будет, опять же, говорить в пользу синхронного сдвига.

Придумать убедительный аргумент из сложности данных против синхронного сдвига вряд ли удастся. Какое преобразование точно сохранит все данные, сколь бы сложными они ни были? Тривиальное, то есть оставить всё на месте. Какое преобразование, выполняющее сдвиг элементов, наиболее близко к тривиальному? Их синхронный сдвиг. Непонятно, какой дальнейший ход рассуждений, включающий апелляции к сложности данных, может вести в сторону высказанной участником точки зрения. Возможно, тот, который связан с последующими псевдоисправлениями. Правда, те рассуждения исходили из противоположной посылки, что имеющиеся данные некачественны, и выводы, соответственно, получаются не вполне совместимые: "не важно, как двигать данные, но по-другому их двигать нельзя". Это участника волновать не будет, так как все эти рассуждения ему не нужны. Он постарается представить ситуацию так, что это ваша задача опровергать правильность правок, а не его - подтверждать.

В общем случае, если структура данных такова, что для работы с ней не годятся ручные сдвиги, то и синхронный сдвиг годится не обязательно. Вместо этого может понадобиться более продвинутое преобразование, применяемое, опять же, синхронно ко всем элементам. Это тоже в большей степени сохранит проявления сложности по сравнению с ручными сдвигами. До рассмотрения подходящих для наших условий преобразований мы дойдём [через несколько глав](../10-transform/). Если не хватит и такого преобразования, то после него уже можно делать необходимые ручные сдвиги, что, опять же, лучше, чем с этих ручных сдвигов начинать. Конечно, будут и такие случаи, где ручные сдвиги понадобятся везде, и тогда можно их делать сразу, но сейчас мы говорим не о них. Выделять подобные случаи из всех остальных участник всё равно не намерен.

Получается, что из сложности данных мы придём к противоположным выводам по сравнению с выводами участника. Он к нашим выводам не придёт, потому что он этого не хочет. Несмотря на заявления о сложности данных, то есть о большом количестве содержащийся в них информации, участник готов делать правки, приводящие к её потерям, и игнорировать способы минимизации этих потерь.

## Несдвинутое может там и находиться

Иногда, сдвигая только часть из того, что следовало бы сдвинуть, участник предлагает этому такое объяснение: раз незатронутые им данные отмечены на определённом месте, то они на самом деле могут там и находиться. Про сдвигаемые им данные участник так почему-то не думает, но, допустим, что их положение он как-либо проверил, а положение прочих данных - нет. Вроде бы всё выглядит правильно: участник не берётся редактировать места, о которых не знает. Подобная позиция противоположна желанию такие места "исправлять". На самом деле эта позиция может оказаться неправильной, как по достаточно очевидным причинам, так и по менее очевидным.

### Очевидные причины

Начнём с достаточно очевидных. Допустим, как и описывалось в начале записи, вы хотите подвинуть стену здания. Что при этом следует сделать с противоположной стеной? Её можно оставить на месте. Объяснить это можно так: отрезки, из которых состоит противоположная стена, проходят через точки, координаты этих точек каким-то способом определялись, способ этот мог быть вполне надёжным, тогда двигать их не надо; или способ был ненадёжный, но мы этого не знаем, а раз так, то не будем их трогать. Но сдвиг только одной из стен приведёт к изменению ширины здания. Что, если вместо определения координат противоположной стены имело место измерение ширины здания? Если так, то исходя из похожих соображений, следовало бы сдвигать и противоположную стену.

Чтобы определить, какой из вариантов действий более правильный, нам придётся догадаться, какой из вариантов измерений был произведён до того. Догадаться обычно очень просто, так как в большинстве случаев измерялась именно ширина. Точнее, непосредственное измерение и не производилось, вместо этого контур здания был проведён согласно спутниковому снимку. Но даже если бы снимок и не был доступен, большинству всё равно легче было бы измерить ширину здания, чем координаты точек на нём. Под "легче" имеется в виду меньшая абсолютная погрешность результата. С точки зрения правильности размеров здания нас будет больше интересовать относительная погрешность - относительно этих размеров. Тогда тем более легче измерить ширину, потому что при этом непосредственно измеряется ширина, а не что-то другое, из чего потом ширина вычисляется.

Проблемы непосредственного измерения ширины здания будут проявляться в большей степени для большой ширины. Например, если здание размером с квартал, то приведённые выше рассуждения уже не столь верны. Есть и другие причины, по которым большие здания нас в этой записи интересуют в меньшей степени, так что пока будем считать, что ширина здания существенно меньше ширины квартала.

Проблемы с вычислением координат точек на зданиях такие: чем ближе вы находитесь к зданию, тем менее точны ваши измерения, потому что здание в большей степени заслоняет собой спутники системы позиционирования. В результате легче определить координаты посреди улицы, чем рядом со зданием. Так обычно и делается: определяются координаты на улице в виде треков, по ним выравнивается снимок, по снимку рисуются здания. Выше я сказал, что даже если по снимку здание не нарисовать, то всё равно легче измерить ширину, чем вычислять координаты, например, углов. Как её измерить? Да хоть шагами. Если вы не верите в свою способность измерить что-либо шагами непосредственно, можете измерить это относительно. Например, ширина здания тридцать шагов, ширина квартала триста, значит здание в десять раз уже, чем квартал.

Однако здесь нам не стоит углубляться в рассмотренные выше методы измерений, потому что, во-первых, заниматься этим для зданий почти наверняка не понадобится, а во-вторых, эта запись не про рисование, а про преобразование уже нарисованного. Все упомянутые приёмы получения данных о размерах зданий, которыми должны были воспользоваться рисовавшие здания участники, нам нужны только для сравнения с деятельностью того, кто взялся нарисованное двигать. Само рисование для этого участника не является основной задачей, значит, вряд ли он с ней справится лучше. Как что было нарисовано не должно быть его проблемой, его проблемой должно быть как это нарисованное не сломать.

Итого, достаточно очевидные причины, почему двигать одни точки объектов и не двигать другие - плохая идея, следующие: *объект уже был нарисован по снимку, при этом была в первую очередь произведена попытка передать его форму, двигая только часть точек, вы эту форму исказите*. Может быть, форма передана неправильно? Попробуйте наложить снимок на объект, и увидите. Некоторые в этом месте начинают утверждать, что снимки некачественные, и по ним ничего по-нормальному не нарисовать. Из этого утверждения следует, что и проверить правильность нарисованного по снимкам нельзя.

Может последовать и более далекоидущее заявление: их собственные действия исправлять не следует до тех пор, пока не появятся более качественные снимки. Снимки могут обновляться, допустим, раз в год, так что участник предлагает потерпеть результаты его правок несколько месяцев. На это можно ответить, что это ему следовало бы потерпеть. Раз снимки настолько плохие, что по ним он не может оценить качество уже нарисованного, то и ему самому не стоит ими пользоваться. Если участник заявит, что он рисует не по снимкам, то мы его спросим, откуда он знает, что до него всё рисовалось исключительно по снимкам. Он, конечно же, этого не знает. В ряде случаев можно заключить, что какая-то область нарисована некачественно по некачественным снимкам, но это не те случаи, из-за которых мы обратим внимание на действия участника.

Чем могут не угодить снимки: низким разрешением, облачностью, тенями, бликами, углом. Низкое разрешение обычно не настолько низкое, чтобы не видно было зданий. Про прочие объекты мы поговорим позже. Если место на снимке закрыто облаком, то это не значит, что оно всегда было закрыто. В тот момент, когда здания рисовались, могла быть доступна другая версия снимка. Если же и тогда место было закрыто облаком, то здания рисовались не по этому снимку, а, значит, не имеет смысла о его качестве рассуждать. Без снимка нарисовано всё могло быть абы как, но участник, который взялся двигать, находится в такой же ситуации, без снимка.

Какое-то место на снимке может быть затенено настолько, что на нём ничего не видно. Так бывает с местами рядом со зданиями, но это возможно и для самих зданий, если рядом с ними есть здания повыше. Но всё-таки существенная часть зданий затенена не будет, скрытой останется лишь небольшая их часть. В отличие от зданий, скрытых облаками, скрытые тенями здания не будут сосредоточены в одной области, и на снимке останется достаточно видимых зданий, чтобы судить о соответствии реальности уже введённой геометрии. Здания по краям квартала, которые наиболее подвержены необдуманным правкам, наименее вероятно затенены, что делает тени не слишком пригодным оправданием таких правок.

Бликами может оказаться скрыта ещё меньшая часть важных объектов, но даже если бы названные и неназванные здесь артефакты снимков скрывали существенную часть объектов, мы могли бы сказать про это то же, что сказали про облака. Вообще же, указания на такие артефакты не вполне соответствуют теме данного раздела, подразумевающей уверенность хотя бы в части ранее введённых данных. К теме, а именно к менее очевидным причинам, почему двигать одно и не двигать другое - плохая идея, мы скоро вернёмся. Для этого мы заметим, что недостатки снимков прежде всего отразятся на мелких зданиях. Мелкие здания типа гаражей, которых может быть не видно даже на различных версиях снимков, часто рисуются относительно других зданий, сравнением их габаритов с прочими объектами на земле.

Перед тем, как перейти к менее очевидным причинам, рассмотрим оставшуюся неприятную особенность снимков - угол, под которым они сделаны. Для большинства задач в первую очередь нужны снимки, сделанные под прямым углом^. Если на снимке видно вертикальную стену здания, то угол в достаточной степени отличается от прямого. Подобный снимок тоже небесполезен, например, по нему удобно рисовать входы в здание, арки и прочее, что можно разглядеть на стене, но для передачи формы здания он подходит хуже.

Тут-то у участника и появляется самая серьёзная возможность заявить про некачественные снимки, по которым ничего точно нельзя нарисовать, а значит всё неточно и было нарисовано, или, что более соответствует текущему подразделу, неверно наше предположение о передаче по снимкам формы здания. Но это участник скажет зря, потому что рисовавшие отлично понимали, что снимок был сделан под углом, и приняли соответствующие меры. Случаи, когда подобного понимания не наблюдается, являются исключениями. Мне, например, известен один такой случай, когда участник обводил место на снимке, сделанным под существенным углом, которое было занято достаточно высоким зданием. В итоге нарисованное здание получилось вдвое шире реального. Здание, правда, уже было нарисовано до того, так что действия данного участника как раз относятся к псевдоисправлениям, о которых речь шла выше.

Форму отдельно взятых зданий передать, а затем проверить достаточно просто и по таким снимкам. Поскольку форма здания обычно совпадает с формой его крыши, а края крыши находятся на примерно одинаковой высоте, достаточно подвинуть снимок так, чтобы крыша, которая будет почти полностью видна, оказалась в том месте, где должно быть здание. Подобное действие следовало бы совершить и участнику, желающему сдвинуть только одну сторону здания. Если до планируемого сдвига размеры нарисованного здания совпадали с размерами крыши на снимке, от сдвига стороны следовало отказаться.

Большей сложностью при работе со снимками под углом является то, что не всегда понятно, насколько надо сдвинуть снимок, чтобы крыша совпала с местом, занимаемым зданием. Этот сдвиг будет своим для каждого здания, если здания разной высоты. Легче всего его сделать, когда видно также и основание здания, тогда крышу надо совместить с основанием. Основание же видно не всегда, так как оно может быть закрыто другим зданием или его тенью. В итоге, внутри кварталов, нарисованных по подобным снимкам, здания бывают смещены относительно друг друга. Можно сказать, что при рисовании по сниму, угол, под которым он был сделан, является основным источником погрешностей. Это особенно верно, когда рельеф местности неровный, но таких подробностей мы здесь рассматривать не будем.

В связи со сказанным стоит обратить внимание на следующие веши:

* То, что здания могут быть сдвинуты относительно друг друга - это не повод искажать их форму. К тому же, сдвинуты они или нет надо сначала установить. Предполагать, что они обязательно сдвинуты - это принимать одно из уже рассмотренных выше оправданий.
* Наибольшие шансы оказаться на месте имеются у зданий, находящихся с краю квартала, за счёт стен, выходящих на улицу. Такие стены будут с меньшей вероятностью чем-то закрыты, а с тех сторон, где их не видно, их можно достроить из различных соображений. Например, виден угол, от которого можно параллельно улице продолжить линию, по которой расположены внешние стены зданий. Но эти же стены наиболее подвержены перемещениям под рассматриваемыми здесь предлогами и по причинам, указанным в начале записи. На самом же деле именно в их положении можно быть наиболее уверенными, а если неверно оно, то, скорее, стоит двигать весь квартал.
* Очень широкие здания, для которых описанные здесь соображения не вполне верны, нас не сильно волнуют, так как относительная погрешность, вносимая нежелательными правками, будет не слишком велика. Если участник намеревается подвинуть лишь внешние стены квартала, а само здание только такими стенами и изображено, то проблем с передачей его формы не будет вообще. Проблемы будут, если что-то отмечено внутри здания, и сейчас мы к ним перейдём.

### Менее очевидные причины { #unmoved-not-obvious }

Итак, мы добрались до менее очевидных причин неправильности точки зрения "оставить часть данных на месте, потому что они, возможно, там и находятся". Это причины, уже не связанные с искажением формы объектов значительного размера, обычно наблюдаемых на снимках. Речь пойдёт о более мелких вещах. Допустим, внутри квартала точкой отмечено дерево. Может быть, координаты этого дерева были точно измерены, и его точка была поставлена ровно по этим координатам. Тогда сдвигать её никуда не нужно, даже если что-то другое, находящееся рядом, двигать следует. То же самое можно сказать и про любой другой мелкий объект типа скамейки или урны.

В реальности подобное маловероятно. Как правило, крупные и мелкие объекты не рисуются одновременно. Часто их рисуют разные участники. Сначала рисуются, конечно же, крупные объекты, и делается это обводкой спутниковых снимков. Желающие рисовать мелочи уже имеют в своём распоряжении место с отрисованными крупными объектами, которыми в нашем случае будут в основном здания. Если готовых крупных объектов ещё нет, то редактирующим такое место участникам всё равно имеет смысл начинать рисовать с крупных объектов, потому что они в любом случае понадобятся.

Зачем при рисовании мелких объектов нужны крупные? Например, для локального выравнивания снимка по ним. Для рисующих мелочи имеет смысл подогнать свои данные под уже имеющиеся значительные другие данные. Своими данными обычно являются распознанные на снимке объекты, обнаруженные при разведке на местности, а подгоном является соответствующий сдвиг снимка. Что если значительных других данных, то есть зданий, ещё нет? Снимок всё равно надо по чему-то выравнивать, и легче это делать по чему-то крупному, а не чему-то, чего на снимке толком не разглядеть.

Зачем нам выравнивать снимок по зданиям, если это можно делать по трекам или по заранее вычисленному кем-то смещению? Как именно мы выравниваем, зависит от ситуации и от наших целей. При рисовании мелких деталей важнее рисовать их правильно относительно зданий, а не абсолютно правильно. К абсолютной правильности мы можем приблизиться и позже, сдвинув потом здания вместе с деталями, что нам будет делать не намного сложнее, если деталей будет становиться больше. Если же детали нарисованы по другому по сравнению со зданием смещению, то тогда у нас проблемы и возникнут, потому что все эти детали придётся из множества сдвигаемых объектов исключать.

В случае, когда мы сами рисуем здания и выравниваем снимок по чему-то другому, здания для его выравнивания не нужны? Возможно, так и есть, но часто и это бывает не так. Мы уже сказали, что крупные и мелкие объекты часто рисуются не одновременно, даже если их рисует один участник. Здания можно  нарисовать, например, диванно-картографическим способом из JOSM, воспользовавшись базой треков для выбора смещения. Детали так уже не нарисовать, потому что с дивана их не видно, и придётся идти на место. На месте рисовать можно, например, из [Vespucci](https://wiki.openstreetmap.org/wiki/RU:Vespucci), но пользоваться при этом треками уже неудобно, да и незачем. Поскольку здания уже нарисованы, снимок легче сдвинуть по ним.

Почему бы в такой ситуации не установить смещение снимка в Vespucci заранее, взяв его из JOSM? Можно поступить и так, но иногда это не то, что нужно. Иногда снимок может понадобиться двигать и во время рисования, и ориентиры в виде зданий в осмовских данных при этом пригодятся. То есть, для целей рисования может не быть какого-то одного правильного смещения, которое можно заранее выставить и больше не трогать. *Самым правильным* смещением снимка будет то, которое выровнено по уровню земли, если какой-то один уровень земли в данном месте в принципе есть. Для рисования объектов, находящихся на этом уровне оно обычно и нужно, но это может быть не так, если самого объекта на снимке найти нельзя.

Пример объекта, который сам обычно находится на уровне земли, и при этом обычно не виден на снимке  - вход в здание. Зато, если это вход на лестничную клетку, часто нужное место можно найти на крыше здания. В этом случае удобнее именно изображение крыши на снимке совместить с осмовским контуром здания. Если снимок сделан под углом, его придётся соответствующим образом сдвинуть. Если здания, с которыми приходится иметь дело, разной высоты, снимок придётся сдвигать неоднократно.

Раз уж в качестве мелкого объекта был упомянут вход в здание, приведём и ещё более очевидную причину, по которой сначала понадобится нарисовать здание: не имеет смысла рисовать вход в здание, не нарисовав самого здания. То же самое можно сказать и о прочих объектах на границе здания, а также о некоторых внутри. Сама необходимость располагать объекты на границе или внутри приведёт и к рисованию здания в первую очередь, и к рисованию относительно него остального. Иногда удаётся или даже приходится рисовать относительно лишь отчасти. Например, если здание очень длинное, иногда объекты отмечают по их абсолютному положению вдоль направления длины здания, но вдоль перпендикулярного направления приходится выбирать место уже относительно здания. Однако, такое полуотносительное рисование подойдёт далеко не для каждого здания, и с увеличением количества отмеченных деталей оно будет становиться всё менее уместным.

Итого, здания и прочие крупные объекты будут нарисованы перед рисованием мелких. Снимок будет выровнен по крупным. После этого на снимке можно либо прямо искать мелкие объекты, либо искать что-то другое, относительно чего известно их расположение. Можем ли мы вместо рисования мелочей по снимку рисовать их, непосредственно определяя их положение? Только что названные причины, по которым рисовать мелкие объекты лучше относительно крупных, мы пока проигнорируем.

Остальные причины, по которым у нас, скорее всего, не получится отмечать мелкие объекты непосредственно, мы уже тоже отчасти упоминали. Измерять координаты объектов внутри квартала может проблематично так же, как это было для координат зданий. Во дворе значительная часть неба со спутниками может быть закрыта зданиями, так что точность измерений окажется неудовлетворительной. Для разных дворов это будет проявляться в разной степени, но в крупном городе проблемы могут быть везде. Например, в Петербурге в центре дворы очень мелкие, а на периферии они попросторнее, зато там здания выше. Если бы кто-то всё-таки взялся за измерение координат, то он наверняка привёл бы в соответствие с ними и здания, и тогда бы двигать не надо было вообще ничего.

Измерять положения всех рисуемых объектов подряд слишком долго, а иногда и невозможно. Например, объект может быть видим, но к нему не подойти. Гораздо проще и быстрее найти его на снимке. Если на снимке его не видно, то его можно нарисовать относительно того, что видно, таким же образом, который мы уже рассматривали для рисования входов в здания. Тут мы снова придём к тому, что мелкие объекты легче рисовать относительно уже имеющихся крупных.

С измерением координат есть ещё одна сложность. Существуют разные системы координат. Разница между ними для пользователя может быть незаметна, а для картографа она будет ощутима. Координаты можно преобразовать из одной системы в другую, в нашем случае - в WGS-84, но при этом тоже можно внести ошибку. Ошибка эта будет абсолютной, относительное же положение объектов и их размеры будут близки к правильному. Из этого в очередной раз следует, что одни объекты рисовались относительно других, и что именно так и легче рисовать.

Если для таких мелких объектов, как входы в здания, подобная мысль вполне очевидна, поскольку они находятся на линиях контуров зданий, то, может быть, это менее очевидно для того, что находится внутри зданий? Рассмотрим ничем не связанные с контуром здания точки магазинов и прочих заведений. Могут ли они быть в правильном месте, даже если всё здание находится в неправильном? Такое маловероятно. Обычно не имеет смысла рисовать магазины в отрыве от здания, в котором они находятся. Измерять координаты магазина, находясь в здании, не получится практически никогда.

Тут мы можем задуматься, есть ли у магазина в принципе какие-либо координаты. Сдвиги, о которых идёт речь в данной записи, как правильные, так и неправильные, осуществляются на расстояние в несколько метров. В таком масштабе, в котором эти несколько метров имеют значение, магазин уже не является точечным объектом. Точка будет уже довольно грубым приближением для объекта, который следовало бы обозначить полигоном. Имеет ли смысл говорить, что положение точки испортится, если оно и так не слишком качественное? Может быть, и не имеет, но это уже другой аргумент про некачественные данные, рассмотренный выше.

Однако, даже если магазин обозначен точкой, которая может гулять туда-сюда на несколько метров размера самого магазина, это не значит, что точка была подобным произвольным методом установлена. Точка может находиться во вполне определённом месте. В какое место ставить точку рекомендую я, вы можете узнать из раздела *POI в виде точек* записи [Как я отмечаю POI – Геометрия](https://www.openstreetmap.org/user/Anton%20Khorev/diary/45247). Смещение, а, точнее, несмещение при смещении всего остального на несколько метров такое расположение точки испортит. В худшем случае, который, тем не менее, довольно распространён, точка магазина останется за пределами здания, в котором она находилась до сдвига, а это будет плохо независимо от того, насколько точно она была установлена.

В общем, есть достаточно причин рисовать одни объекты относительно других и пытаться передать их размеры. Значит, так скорее всего и было сделано до попыток сдвига. Значит, и сдвигать надо было всё вместе. На случай, если кто-то захочет сказать, что раз вместе с одним надо двигать и другое, а другое всегда рядом есть, то придётся двигать и двигать, и непонятно, где остановиться, я напомню, что остановиться я предлагаю на границе квартала.

## Я также вносил уточнения { #i-did-improvements }

### Откат это вандализм

Все описанные действия по сдвиганию части данных выполняются, обычно, не просто так, а ради внесения каких-либо новых данных. Это предоставляет участнику возможность возражать против отката его правок, так как откат будет также и удалением добавленного. Удаление он может назвать вандализмом, сказать, что пожалуется в DWG, и даже на самом деле пожаловаться.[^3-dwg]

[^3-dwg]: Все фрагменты данной записи с упоминанием DWG были написаны в апреле 2019 г., то есть до вступления туда автора.

Если у участника сравнительно небольшой стаж, демонстрация им знания буквосочетания "DWG" говорит о том, что это новая учётная запись другого участника. Новая учётка могла ему потребоваться для сброса сомнительной репутации или для обхода блокировки. Зачем тогда иметь дело с DWG, если предыдущий опыт общения с этой инстанцией уже имел отрицательные последствия? Видимо, затем, что опыт уже есть, и участник считает, что в этот раз у него получится лучше, или это попытка отомстить конкретному участнику или сообществу вообще. Если правосудие покарало в прошлый раз его, может быть, в этот раз оно покарает кого-то другого. Этот другой ведь ничем не лучше рассматриваемого участника, по мнению самого этого участника.

Если дело дошло до обсуждения блокировок, то дальнейшие разговоры с участником могут казаться бесполезными. С точки зрения предмета данной записи они на самом деле бесполезны, запись рассчитана на тех, кого можно переубедить. С более общей же точки зрения сохранности данных смысл в них есть. Чем больше участник говорит, тем легче определить, кем он на самом деле является. Если же он говорить откажется, то это тоже хорошо в плане оформления для него новой блокировки.

Оставим рассуждения про DWG и блокировки и перейдём к содержимому правок. Дальнейшее зависит от того, какого рода были внесены уточнения, в каком количестве и уточнения ли это в принципе. Если участником были добавлены данные, соответствующие действительности, и их нетрудно выделить, то можно откатить всё, кроме них. Например, плагин reverter для JOSM позволяет это сделать. Особенно легко это сделать, если добавленные данные находятся вне квартала - тогда достаточно выделить квартал способом, описываемым в [одной из следующих глав](../6-select/).

Описанная выше ситуация возникнет, например, если участник нарисовал тротуар вдоль зданий. Сама линия тротуара является полезной информацией, и её откатывать мы не будем. После выборочного отката всего остального тротуар окажется расположенным не вполне правильно, в худшем случае он пойдёт поверх зданий. Если так, то его можно по-быстрому подвинуть. Сильно стараться при этом не следует, так как главная задача - правильно выполнить откат, особенно, если правки участника распределены по нескольким пакетам.

Поскольку эта глава не про откаты, а про аргументы, подробности выполнения операций я описывать не буду, цель написанного - показать, что́ можно сделать, чтобы лишить участника возможности возмущаться про вандализм. В принципе, даже полный откат вандализмом не будет, но мы же не станем удалять те полезные данные, которые можно сохранить. Если участник предпочитает любые потери данных называть вандализмом, то то же самое можно сказать и про его собственные правки.

Даже если участник перестанет заявлять про вандализм, или если он этого и не делал, откат ему может не понравиться и по другим причинам. Например, в описанном выше сценарии с тротуаром, тротуар после отката окажется проведён кривовато. Это может послужить поводом заявлять, что после ваших действий данные стали хуже, значит, выполнять эти действия не следовало, значит, участник прав. На самом деле, ничего такого это не значит, участник просто выборочно обращает внимание на данные, важные для него, и игнорирует другие. Оставлять кривую линию тротуара, конечно же, не обязательно, её можно поправить после отката, проведя прямо относительно имеющегося положения зданий, или сдвинув здания правильно. Если участнику так важны его данные, то он как раз может этим заняться. Правда, скорее всего, делать он этого не будет, особенно он не будет делать сдвиг, потому что не умеет либо ему лень, зато возмущаться продолжать будет. И пожалуйста, главное, чтобы он перестал делать правки сомнительной полезности, иначе придётся вспоминать про упомянутый выше DWG.

Иногда данные добавляются участником не вне квартала и отдельно от сдвигаемых зданий, а так, что их проблематично отделить от того, что следует откатить. Решение откатить всё подряд нам всегда доступно, но есть и другие варианты. Подобно избирательному откату можно выполнить избирательный сдвиг с целью восстановления имевшейся ранее геометрии. Эта и прочие более сложные по сравнению с обычным откатом операции нам не понадобятся, если добавленные данные являются вымышленными. Одну из разновидностей внесения вымышленных данных мы уже рассматривали - это были псевдоисправления посредством упрощения. Теперь рассмотрим усложнение данных - добавление несуществующих в реальности деталей. В первую очередь нас интересуют детали контуров зданий, так как именно здания и подвержены рассматриваемым здесь сдвигам.

Вопрос о том, какая форма контура правильная, не такой простой. В качестве ответа я бы назвал проекцию упрощённой формы здания, но ясно, что это не однозначный ответ, потому что он зависит от степени упрощения. Упрощаю форму я до такой степени, которая соответствует выбранным для обозначения здания средствам, что, конечно же, по-прежнему неоднозначный ответ, так как он зависит от выбора средств. Пример можно привести такой: допустим, есть пятиэтажное здание с крыльцом. Стану ли я считать крыльцо частью здания? Допустим, я готов обозначить здание в виде одного контура с тегом этажности, а {% tag "building:part" %} я использовать не хочу. Тогда крыльцо я в контур не включу, так как оно в высоту гораздо меньше, чем пять этажей. Чтобы крыльцо включить, мне понадобится придумать для него подходящий {% tag "building:part" %}.

На тему формы зданий можно много чего написать, и данная запись - неподходящее для этого место. Заметим только, что форма может быть не вполне видна на снимках. На снимке, сделанном под углом, детали, выступающие вверх, можно принять за выступающие в сторону. Даже на [ортоснимке](https://ru.wikipedia.org/wiki/Ортофотоплан) тот контур, который описал я, будет не виден из-за нависающих элементов типа карнизов. Другая выбранная детализация и средства обозначения, другое мнение по поводу включения элементов, особенности снимков - всё это даёт возможность участнику добавить детали к зданию.

### Коптерные снимки

Пожалуй, придётся ещё остановиться на некоторых видах не обязательно полезных уточнений, которые возникают при рисовании по коптерным снимкам. Эти снимки, некоторые их особенности и выполненные по ним уточнения были упомянуты ещё в начале записи. Нежелательные для нас уточнения можно разделить на три разновидности:

1. рисование в реальности несуществующих погрешностей снимка;
2. слишком локальное рисование реальных деталей без попытки предварительного сдвига квартала;
3. рисование излишних деталей.

С первыми двумя разновидностями всё просто. Правки первого типа вообще не стоило делать. Выполнившие их участники и не стали бы их делать, будь у них поменьше уверенности в правильности наблюдаемой ими картинки. Излишняя же уверенность берётся, видимо, из относительно высокого разрешения снимков по сравнению с тем, что было доступно ранее. Перерисовывание особенностей снимка, не имеющих отношения к реальности, конечно же, может происходить с любыми снимками, а не только с коптерными. Для коптерных снимков в данном случае специфично то, что до них уже был доступен какой-то другой снимок, по которому уже было что-то нарисовано, причём нарисовано попроще, а теперь производится якобы уточнение.

Про вторую разновидность правок вся эта запись говорит, что надо было сначала двигать квартал. Если квартал двигать лень, подвиньте снимок под текущее неправильное смещение, рисуйте детали по нему, а сдвиг квартала оставьте для других участников. Но нередко попадаются ситуации, когда дорисовка деталей идёт по новому смещению при том, что большая часть данных квартала оставляется на месте. Крайним случаем является перемещение угла здания на новое смещение, а дополнительная детализация заключается в том, что он срезается, то есть одна точка заменяется двумя. Ради этого у здания изгибаются стены, так как остальные их точки остаются на месте. В принципе, и добавления деталей может не быть, и правка будет состоять только из перемещения угла. Это уже не совсем соответствует теме данного раздела, но результат примерно такой же: искривление здания, которое выполнивший его участник может называть "уточнением" или "детализацией".

На тему третьего вида правок уже можно поспорить. Детали, которые я назвал излишними, являются таковыми с точки зрения приведённых выше рассуждений про форму зданий. То есть, излишними они, как и любые другие детали, могли бы не быть при правильном выборе средств их обозначения. Однако рисующие по коптерным снимкам выбора обычно не делают, а просто модифицируют уже имеющийся объект. Здание часто бывает обозначено одним полигоном или одним мультиполигоном, и рисующие по коптерным снимкам просто модифицируют его контур. Проблемы для нас могут заключаться в том, насколько модифицированный контур будет отличаться от желаемого.

В качестве примера можно привести попытку нарисовать различия между шириной крыш даже для зданий, идущих по одной линии, поскольку именно края крыш оказались видны на снимке. Это создаст неудобства как для перемещения квартала по рассматриваемому далее методу, так и для последующего добавления объектов, ради которого перемещение и затевалось. Многие объекты, добавляемые к зданию, типа входов и почтовых ящиков ставятся на существующие линии здания. Обычно такой линией является внешний контур здания, потому что никакой другой подходящей линии нет. Но это также и имеет смысл, пока внешний контур идёт по линии фасада, ведь именно на этой линии данные объекты и находятся. Если же контур здания до нас решили "уточнить" по краям их изображений с коптерного снимка, то это уточнение являлось заодно и отказом от линии фасада. Если над почтовым ящиком расположен балкон, и кто-то включил балкон в контур здания, мы же не будем отодвигать ящик от его места на ширину балкона?

Если бы рисующие по коптерным снимкам участники оставляли и линию фасада, проблем бы с их деятельностью не было, но они так не делают. Они могут оправдать свои действия тем, что разница между "их" линией и линией фасада незначительна. В этом случае мы можем их спросить, зачем тогда эту незначительную разницу вырисовывать? Ещё они могут привести примеры того, как сам фасад не идёт по прямой, и что их уточнения добавляют данные об этом. Мы же можем возразить, что непосредственно отклонений фасада на снимках обычно не видно, так что рисуют они по прежнему края крыш.

Правки последнего типа могут доставить неприятности независимо от того, являются ли они рисованием по отличающемуся от представленного в данных смещения или нет. Если отличия в смещении нет, то к теме данной записи такие правки не относятся. Нас пока что интересуют только "уточнения", являющиеся приправой к сдвигам. Хотя даже если изменение смещения и имело место, это не значит, что их обязательно надо откатывать. Если всё нарисованное до того было корявым, но наблюдаемым на снимках, результат даже псевдоуточнений будет, скорее всего, не хуже, особенно, если они затрагивают весь квартал. Тем не менее, готовьтесь обнаружить отдельные точки, про которые забыли, и которые  остались по старому смещению, чего не произошло бы, если выполнявшие сдвиг участники действовали так, как рекомендуется в данной записи.

### Фейковые уточнения

Рассмотренные уточнения по коптерным снимкам имеют по крайней мере какое-то отношение к реальности, даже если оно не совсем такое, как хотелось бы редактирующим. Бывают и такие ситуации, когда никакого соответствия между добавленными деталями и реальностью обнаружить невозможно. Тогда можно предположить, что и причины для их добавления были другие: сделать более красиво, осложнить откат, иметь возможность возмущаться, что откат приводит к деградации геометрии. Делание более красиво может заключаться в добавлении регулярно расположенных выступов преувеличенных размеров. Размеры приходится преувеличивать, иначе публика может красивостей не разглядеть. Найти какое-либо соответствие нарисованных выступов с реальностью может не удаться вообще, так как возможные подходящие элементы здания могут отличаться и длиной, и шириной, и количеством.

Добавление спорных деталей следовало бы делать отдельно от спорных сдвигов. Тем, кому лень правильно выполнить сдвиг, стоит сначала нарисовать детали по старому смещению, а сдвиг... можно было бы сказать "сделать потом", но ясно, что лучше его совсем не делать, чем делать коряво. Детали на здании затрагивают в основном само здание, и, если они неправильные, от них легко отделаться, просто их удалив. Изменение же размеров и взаимного расположения зданий затронет и всё, что между ними. Вполне можно было бы нарисовать детали по тому смещению, которое кажется неправильным, а не подсовывать их в пакет со сдвигом или посреди серии таких пакетов.

Вообще, то, что менее спорно, и то что легче правильно выполнить, стоит делать перед тем, что более спорно и сложнее для исполнения. Этот совет, конечно, не поможет излишне уверенным в своей правоте. Кроме того, спорность и простота исполнения могут с точки зрения отдельного участника быть направлены противоположно, и, соответственно, предполагать противоречивую последовательность действий. Можно надеяться, что тем, кто прочитает данную запись, выполнить сдвиг правильным образом станет легче, и именно с этого действия, если оно необходимо, они и станут начинать редактирование мест, требующих дополнительной детализации.

## Итоги оправданий

Выше было рассмотрено то, что можно услышать от делающих кривые сдвиги. Конечно, они могут придумать что-нибудь ещё, но нам придётся остановиться на уже написанном, потому что глава получилась и так гораздо больше, чем можно было бы ожидать.

Из написанного выше не следует делать выводов, что сдвигающий всегда неправ, и что двигать ничего не нужно. Последнее возможно лишь в определённой степени, соответствующей принятой точности. Претензии мы в основном предъявляли к выбранному участником методу сдвига, который сам по себе ограничивает точность. Как мы уже знаем, даже по идеальным снимкам с высоким разрешением может не получиться нарисовать здания точнее нескольких дециметров. Чтобы получить в определённом смысле более качественный результат, понадобится сделать нечто большее, чем просто подвинуть точки на углах здания на те места, которые видны на снимке. Этот определённый смысл может зависеть от того, хотим ли мы расположить здание строго параллельно дороге, добиться определённой симметрии, а также от выбора средств и детальности обозначения здания.

Мест, где существует необходимость что-то подвинуть на метр-два должно быть достаточно много. Это не обязательно означает, что данные вводятся с метровой точностью. Необходимость что-либо подвинуть на небольшое расстояние может следовать из окружающих данных, с которыми имеет смысл привести в соответствие редактируемые. Например, мы можем знать, что несколько точек находятся на одной линии, и их приведение в такое состояние потребует подобных сдвигов. То же можно сказать и о прочих уже упомянутых соображений качества. При этом абсолютной точности, эквивалентной расстояниям сдвигов у нас может и не быть.

Даже и метод ручного сдвига отдельных точек может оказаться приемлемым в ряде случаев. Если здание очень большое, так что относительные искажения размеров будут малы, если у здания и так форма неправильная, и для него не предпринималось попыток делать indoor mapping, если здания неверно расположены друг относительно друга и между ними ничего не нарисовано - в таких случаях от ручного сдвига не будет существенного вреда. Главный же случай - это когда квартал уже и так совмещён со снимком или другим источником настолько хорошо, насколько это было возможно, но поправки всё равно требуются. Проблема в том, что сдвигающие часто не намерены определять, имеют ли эти случаи место там, где им захотелось поредактировать.

Видно, что тех, кто хочет делать сдвиги, можно поделить на две группы: радикалы, заявляющие, что всё везде расположено неправильно, и те, кто придерживается подобного мнения лишь об отдельных местах. То, что в этой записи последует дальше, рассчитано в основном на вторых. Первым, в случае их правоты, может понадобиться сдвигать данные частями, которые гораздо больше кварталов. Вторых можно поделить на тех, кто двигает одни данные, чтобы ввести другие, и тех, кто двигает, чтобы уточнить непосредственно сдвигаемое. Двигающие ради других данных с меньшей вероятностью будут заботиться об абсолютной точности координат, а двигающих ради двигаемого будет меньше интересовать сохранность относительного положения. В итоге подпортить данные могут и те, и те. Дальнейшее написано для того, чтобы показать, что надо делать, чтобы портить поменьше.
