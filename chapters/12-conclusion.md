---
title: Заключение
---

Наконец мы уж точно можем считать, что справились с поставленной задачей, и выгрузить правки на сервер. Я же могу посмотреть на эту запись, которую я собирался написать за пару дней, чтобы оценить, что в ней *написано*, и что *не написано*. *Ненаписанное* объясняется тем, что мне тоже хотелось бы считать, что я справился с поставленной задачей, и не хотелось бы, чтобы пара дней превратилась в пару лет. Вот что осталось за рамками данной записи и может послужить основой для её продолжения:
- Ещё в начале записи рассматривалось явление, названное *эволюцией данных*. *Эволюция* - весьма весомое слово, которое лучше не употреблять без серьёзных оснований. Однако, в записи толком не рассматривается, что и посредством чего эволюционирует, и выполняются ли необходимые для этого условия. Также в записи делаются утверждения, куда эволюция идёт, но не приводятся ни систематические качественные, ни, тем более, количественные подтверждения этого. То есть, всё это может оказаться верным только для тех мест, которые я редактирую, и неверным в общем. Конечно, рассмотрение этого вопроса представляет в большей степени теоретический интерес, и было бы нужно, чтобы превратить запись в подобие диссертации.
- Практический же интерес представляет обобщение используемых в записи для перемещения кварталов геометрических преобразований на области другой формы. В первую очередь нас интересуют многоугольники с бо́льшим количеством углов, то есть мы хотим узнать преобразования, пригодные для кварталов с пятью и более углами. При переходе от линейного преобразования для треугольников к тому, которое мы используем для четырёхугольников, нам пришлось отказаться от координатных осей, и использовать вместо них линии координатной сетки, распределённые между противоположными сторонами четырёхугольника. При дальнейшем увеличении количества углов мы лишимся и противоположных сторон, так что преобразование придётся снова существенно менять, и результатами этого изменения я пока не пользовался.
- Рассмотренные преобразования реализуются через плагин CommandLine, написание скриптов для которого можно тоже рассмотреть детальнее. Во-первых, можно более прилично переписать сами скрипты. Для этого могут понадобиться дополнительные абстракции. В своём стандартном виде, без моих модификаций, код скриптов работает с осмовскими элементами. Для своих скриптов я использую прослойку, которая позволяет работать с геометрическими точками и векторами. Но в этой записи мы рассматриваем системы координат и преобразования между ними, а для них соответствующие абстракции пока не реализованы. После их реализации будет больше смысла в объяснениях того, как писать скрипты для плагина.
- Ещё перед преобразованием нам нужны направляющие линии, которые легче всего получить из осевых линий улиц, если они существуют в подходящем виде. В противном случае осевые линии стоило бы нарисовать или перерисовать, чтобы также улучшить линии улиц, тротуаров и всего им параллельного, и чтобы конечное положение квартала всем этим линиям соответствовало. О том, как это лучше сделать, особенно при наличии не слишком качественных снимков, стоит написать отдельно. Сначала, когда я хотел написать эту запись за пару дней, рассматривать в ней перерисовку осей я не собирался. Потом, когда стало ясно, что запись получится длиннее, я решил, что позже допишу в конце раздел про это. Ещё позже стало ясно, что запись и так слишком длинная, и даже странно, что я её до сих пор называю "записью". Но повод исключить этот раздел есть: он был бы про улицы, а эта запись - про кварталы, и в разделе рассматривалось бы редактирование с другими целями.
- Некоторые из поправок после сдвига квартала тоже приближаются к редактированию с другими целями. В качестве примера можно назвать расстановку объектов на передней стене здания с помощью Shift+B. Её продвинутый вариант связан с добавлением временных точек, что может делаться на основе подсчёта окон между объектами и краями здания. Всё это нужно либо для корректировки объектов внутри и непосредственно у здания, либо для добавления деталей. Ради последующего добавления деталей мы, вероятно, и выполняем сдвиг, то есть детали мы добавим после сдвига, а значит, и рассматривать их добавление лучше после, в другой записи. Корректировкой же внутри здания мы здесь занимаемся только в той степени, которая нас не слишком утруждает. Если она требует каких-то продвинутых методов, то её тоже лучше оставить на потом. Поскольку внутри зданий часто отмечают [POI](https://wiki.openstreetmap.org/wiki/RU:Точки_интереса), вся эта тема близка к тому, что рассматривается в серии записей про POI, и там же к ней, возможно, стоит перейти.
- Также, редактируя контуры зданий и проезды, мы можем затронуть их и внутри квартала, после чего нам будет не удержаться от дальнейших правок в этом месте. Однако, в полной мере мы их провести не сможем, если мы сами не видели квартал изнутри. Описываемые же в этой записи действия предполагали, что никакой разведки на местности внутри квартала мы не проводили, поэтому в их основе лежит минимизация относительных искажений незнакомой нам непосредственно геометрии квартала. К тому же изменение и дополнение внутренностей квартала, особенно, выполняемое прямо на месте, требует других средств редактирования, в частности, [Vespucci](https://wiki.openstreetmap.org/wiki/RU:Vespucci). Рассмотрение этих средств тоже является отдельной темой.

Обещать, что из этого когда будет и будет ли в принципе написано я здесь не стану. Эту запись я хотел по-быстрому написать перед следующей про POI, которая тоже разрослась, и даже не будучи дописанной, уже существенно превышает свою предшественницу. Короткая запись про отдельно взятую операцию сдвига квартала должна была заполнить дневник, пока дописывалась длинная запись про POI. Ранее ту же роль сыграла запись про тег {% tag "level" %}, в которой я тоже обещаю продолжение, которое тоже неизвестно когда напишу, как и продолжение про maps.me. Ещё я начал писать про [OsmAnd](https://wiki.openstreetmap.org/wiki/RU:OsmAnd), так что следующей записью, которая появится неизвестно когда, может стать любая из перечисленных, или что-то совсем другое.

Что можно сказать о *написанном* в данной записи? Мне не хотелось, чтобы главы получились несбалансированными, то есть чтобы одна из них была гораздо больше других без серьёзной причины. Из-за этого и была написана большая часть текста, и данная запись раздулась до своих настоящих размеров. Первым делом была написана глава с критикой действий и аргументов несогласных с рассматриваемым здесь подходом. Для этой главы серьёзных причин быть доминирующей как раз и нет. Чтобы запись не состояла преимущественно из посланий к другим участникам о том, как они ошибаются, от того, кто не смог вовремя остановиться эти послания писать, пришлось дописать достаточное количество всего остального. В результате получилась запись про то, как использовать [JOSM](https://wiki.openstreetmap.org/wiki/RU:JOSM).

Серьёзной причиной сделать какую-либо главу побольше может быть то, что при редактировании на выполнение действий, описываемых в этой главе, уходит большая часть времени. Понятно, что к главе с критикой этого отнести нельзя. Но также это не относится и к центральной главе про сами преобразования. Может показаться, что эта глава должна быть основной, в том числе и по размеру, но на запуск одного скрипта много времени не уйдёт. Гораздо больше времени требуют исправления после сдвига квартала, и, соответственно, гораздо больше их глава. Да и сами скрипты преобразований довольно простые. Писать их гораздо легче, чем писать *про* них.

Теперь можно считать, что в данной записи написано достаточно и про скрипты, и про прочее, и даже про то, как про всё это написано, и её можно, наконец, завершить.
